@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── ShadCN dark theme variables ─────────────────────── */
@layer base {
  :root {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 5.5%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 5.5%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
    --radius: 0.75rem;
  }

  * {
    @apply border-border;
    scrollbar-width: thin;
    scrollbar-color: hsl(0 0% 20%) transparent;
  }

  *::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    background: hsl(0 0% 20%);
    border-radius: 3px;
  }

  *::-webkit-scrollbar-thumb:hover {
    background: hsl(0 0% 30%);
  }

  html,
  body,
  #root {
    @apply h-full overflow-hidden;
  }

  body {
    @apply bg-background text-foreground;
  }

  ::selection {
    background: rgba(148, 163, 184, 0.3);
  }
}

/* ── animations ───────────────────────────────────────── */
@keyframes slide-up {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse-dot {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 1; }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.animate-slide-up {
  animation: slide-up 0.25s ease-out;
}

.animate-pulse-dot {
  animation: pulse-dot 1.2s ease-in-out infinite;
}

.animate-fade-in {
  animation: fade-in 0.2s ease-out;
}

/* ── prose overrides for chat messages ────────────────── */
@layer components {
  .prose-chat {
    @apply text-foreground leading-relaxed text-sm max-w-none break-words;
  }

  .prose-chat p {
    @apply mb-2 last:mb-0;
  }

  .prose-chat strong {
    @apply text-foreground font-semibold;
  }

  .prose-chat em {
    @apply italic;
  }

  .prose-chat h1,
  .prose-chat h2,
  .prose-chat h3,
  .prose-chat h4 {
    @apply text-foreground font-semibold mt-4 mb-2;
  }

  .prose-chat h1 { @apply text-xl; }
  .prose-chat h2 { @apply text-lg; }
  .prose-chat h3 { @apply text-base; }
  .prose-chat h4 { @apply text-sm; }

  .prose-chat ul,
  .prose-chat ol {
    @apply pl-5 mb-3 space-y-1;
  }

  .prose-chat ul { @apply list-disc; }
  .prose-chat ol { @apply list-decimal; }

  .prose-chat li {
    @apply text-card-foreground;
  }

  .prose-chat li p {
    @apply mb-1;
  }

  .prose-chat code {
    @apply bg-muted text-foreground px-1.5 py-0.5 rounded text-sm font-mono;
  }

  .prose-chat pre {
    @apply bg-muted rounded-lg p-4 my-3 overflow-x-auto;
  }

  .prose-chat pre code {
    @apply bg-transparent p-0 text-muted-foreground;
  }

  .prose-chat blockquote {
    @apply border-l-2 border-border pl-4 my-3 text-muted-foreground italic;
  }

  .prose-chat a {
    @apply text-primary underline hover:text-primary/80 transition-colors;
  }

  .prose-chat table {
    @apply w-full border-collapse my-3;
  }

  .prose-chat th {
    @apply bg-muted px-3 py-2 text-left text-sm font-medium text-muted-foreground border border-border;
  }

  .prose-chat td {
    @apply px-3 py-2 text-sm border border-border;
  }

  .prose-chat hr {
    @apply border-border my-4;
  }

  .prose-chat img {
    @apply rounded-lg max-w-full max-h-80 my-2;
  }
}

/* ── streaming cursor ─────────────────────────────────── */
.streaming-cursor::after {
  content: '▎';
  animation: pulse-dot 0.8s ease-in-out infinite;
  color: hsl(0 0% 63.9%);
  font-weight: bold;
}

/* ── streaming text fade-in (Gemini-style) ────────────── */
@keyframes stream-fade-in {
  from {
    opacity: 0;
    filter: blur(2px);
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    filter: blur(0);
    transform: translateY(0);
  }
}

.streaming-fade-in .prose-chat > *,
.streaming-fade-in .prose-chat {
  animation: stream-fade-in 0.4s ease-out both;
}

.streaming-fade-in .prose-chat > *:last-child {
  animation: stream-fade-in 0.35s ease-out both;
}
